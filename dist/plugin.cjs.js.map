{"version":3,"file":"plugin.cjs.js","sources":["esm/script.js","esm/web.js","esm/index.js"],"sourcesContent":["/* eslint-disable @typescript-eslint/explicit-module-boundary-types */\n/* eslint-disable @typescript-eslint/no-unused-vars */\n// Load a script from given `url`\nconst loadScript = function (url) {\n    return new Promise(function (resolve, _reject) {\n        const script = document.createElement('script');\n        script.src = url;\n        script.addEventListener('load', function () {\n            // The script is loaded completely\n            resolve(true);\n        });\n        document.head.appendChild(script);\n    });\n};\n// Perform all promises in the order\nconst waterfall = function (promises) {\n    return promises.reduce(async function (p, _c) {\n        // Waiting for `p` completed\n        await p;\n        // await c();\n        return true;\n    }, \n    // The initial value passed to the reduce method\n    Promise.resolve([]));\n};\n// const test = () => {\n//   return dd\n// }\n// Load an array of scripts in order\nconst loadScriptsInOrder = (arrayOfJs) => {\n    const promises = arrayOfJs.map(function (url) {\n        return loadScript(url);\n    });\n    return waterfall(promises);\n};\nexport { loadScriptsInOrder };\n//# sourceMappingURL=script.js.map","/* eslint-disable no-async-promise-executor */\n/* eslint-disable @typescript-eslint/no-var-requires */\nimport { WebPlugin } from '@capacitor/core';\nimport { loadScriptsInOrder } from './script';\nconst appleScriptUrl = 'https://appleid.cdn-apple.com/appleauth/static/jsapi/appleid/1/en_US/appleid.auth.js';\nlet isAppleScriptLoaded = false;\nasync function authorize(options) {\n    return new Promise(async (resolve, reject) => {\n        var _a, _b, _c;\n        if (options) {\n            isAppleScriptLoaded = await loadAppleSignJS();\n            if (isAppleScriptLoaded) {\n                AppleID.auth.init({\n                    clientId: options.clientId,\n                    redirectURI: options.redirectURI,\n                    scope: (_a = options.scopes) !== null && _a !== void 0 ? _a : undefined,\n                    state: (_b = options.state) !== null && _b !== void 0 ? _b : undefined,\n                    nonce: (_c = options.nonce) !== null && _c !== void 0 ? _c : undefined,\n                    usePopup: true,\n                });\n                AppleID.auth\n                    .signIn()\n                    .then((res) => {\n                    var _a, _b;\n                    const response = {\n                        response: {\n                            user: res.user,\n                            email: (_a = res.user) === null || _a === void 0 ? void 0 : _a.email,\n                            state: (_b = res.user) === null || _b === void 0 ? void 0 : _b.state,\n                            id_token: res.authorization.id_token,\n                            code: res.authorization.code,\n                        },\n                    };\n                    resolve(response);\n                })\n                    .catch((err) => {\n                    reject(err);\n                });\n            }\n            else {\n                reject('Unable to load Sign in with Apple JS framework.');\n            }\n        }\n        else {\n            reject('No options were provided.');\n        }\n    });\n}\nfunction loadAppleSignJS() {\n    return new Promise(resolve => {\n        if (!isAppleScriptLoaded) {\n            if (typeof window !== undefined) {\n                // const script = scriptjs;\n                loadScriptsInOrder([appleScriptUrl]);\n            }\n            else {\n                resolve(false);\n            }\n        }\n        else {\n            resolve(true);\n        }\n    });\n}\nexport class SigninWithAppleWeb extends WebPlugin {\n    async authorize(options) {\n        return authorize(options);\n    }\n}\nexport { authorize };\n//# sourceMappingURL=web.js.map","import { registerPlugin } from '@capacitor/core';\nimport { authorize } from './web';\nconst SigninWithApple = registerPlugin('SigninWithApple', {\n    web: () => import('./web').then(m => new m.SigninWithAppleWeb()),\n});\nexport * from './definitions';\nexport { SigninWithApple, authorize };\n//# sourceMappingURL=index.js.map"],"names":["WebPlugin","registerPlugin"],"mappings":"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"}