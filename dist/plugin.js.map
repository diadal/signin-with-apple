{"version":3,"file":"plugin.js","sources":["esm/web.js","esm/index.js"],"sourcesContent":["/* eslint-disable @typescript-eslint/no-var-requires */\nimport { WebPlugin } from '@capacitor/core';\nimport scriptjs from 'scriptjs';\nconst appleScriptUrl = 'https://appleid.cdn-apple.com/appleauth/static/jsapi/appleid/1/en_US/appleid.auth.js';\nlet isAppleScriptLoaded = false;\nasync function authorize(options) {\n    return new Promise(async (resolve, reject) => {\n        var _a, _b, _c;\n        if (options) {\n            isAppleScriptLoaded = await loadAppleSignJS();\n            if (isAppleScriptLoaded) {\n                AppleID.auth.init({\n                    clientId: options.clientId,\n                    redirectURI: options.redirectURI,\n                    scope: (_a = options.scopes) !== null && _a !== void 0 ? _a : undefined,\n                    state: (_b = options.state) !== null && _b !== void 0 ? _b : undefined,\n                    nonce: (_c = options.nonce) !== null && _c !== void 0 ? _c : undefined,\n                    usePopup: true,\n                });\n                AppleID.auth\n                    .signIn()\n                    .then((res) => {\n                    var _a, _b;\n                    const response = {\n                        response: {\n                            user: res.user,\n                            email: (_a = res.user) === null || _a === void 0 ? void 0 : _a.email,\n                            state: (_b = res.user) === null || _b === void 0 ? void 0 : _b.state,\n                            id_token: res.authorization.id_token,\n                            code: res.authorization.code,\n                        },\n                    };\n                    resolve(response);\n                })\n                    .catch((err) => {\n                    reject(err);\n                });\n            }\n            else {\n                reject('Unable to load Sign in with Apple JS framework.');\n            }\n        }\n        else {\n            reject('No options were provided.');\n        }\n    });\n}\nfunction loadAppleSignJS() {\n    return new Promise(resolve => {\n        if (!isAppleScriptLoaded) {\n            if (typeof window !== undefined) {\n                const script = scriptjs;\n                script(appleScriptUrl, () => resolve(true));\n            }\n            else {\n                resolve(false);\n            }\n        }\n        else {\n            resolve(true);\n        }\n    });\n}\nexport class SigninWithAppleWeb extends WebPlugin {\n    async authorize(options) {\n        return authorize(options);\n    }\n}\nexport { authorize };\n//# sourceMappingURL=web.js.map","import { registerPlugin } from '@capacitor/core';\nimport { authorize } from './web';\nconst SigninWithApple = registerPlugin('SigninWithApple', {\n    web: () => import('./web').then(m => new m.SigninWithAppleWeb()),\n});\nexport * from './definitions';\nexport { SigninWithApple, authorize };\n//# sourceMappingURL=index.js.map"],"names":["scriptjs","WebPlugin","registerPlugin"],"mappings":"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"}