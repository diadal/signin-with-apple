{"version":3,"file":"plugin.js","sources":["esm/script.js","esm/web.js","esm/index.js"],"sourcesContent":["/* eslint-disable @typescript-eslint/explicit-module-boundary-types */\n/* eslint-disable @typescript-eslint/no-unused-vars */\n// Load a script from given `url`\nconst loadScript = function (url) {\n    return new Promise(function (resolve, _reject) {\n        const script = document.createElement('script');\n        script.src = url;\n        script.addEventListener('load', function () {\n            // The script is loaded completely\n            resolve(true);\n        });\n        document.head.appendChild(script);\n    });\n};\n// Perform all promises in the order\nconst waterfall = function (promises) {\n    return promises.reduce(async function (p, _c) {\n        // Waiting for `p` completed\n        await p;\n        // await c();\n        return true;\n    }, \n    // The initial value passed to the reduce method\n    Promise.resolve([]));\n};\n// const test = () => {\n//   return dd\n// }\n// Load an array of scripts in order\nconst loadScriptsInOrder = (arrayOfJs) => {\n    const promises = arrayOfJs.map(function (url) {\n        return loadScript(url);\n    });\n    return waterfall(promises);\n};\nexport { loadScriptsInOrder };\n//# sourceMappingURL=script.js.map","/* eslint-disable no-async-promise-executor */\n/* eslint-disable @typescript-eslint/no-var-requires */\nimport { WebPlugin } from '@capacitor/core';\nimport { loadScriptsInOrder } from './script';\nconst appleScriptUrl = 'https://appleid.cdn-apple.com/appleauth/static/jsapi/appleid/1/en_US/appleid.auth.js';\nlet isAppleScriptLoaded = false;\nasync function authorize(options) {\n    return new Promise(async (resolve, reject) => {\n        var _a, _b, _c;\n        if (options) {\n            isAppleScriptLoaded = await loadAppleSignJS();\n            if (isAppleScriptLoaded) {\n                AppleID.auth.init({\n                    clientId: options.clientId,\n                    redirectURI: options.redirectURI,\n                    scope: (_a = options.scopes) !== null && _a !== void 0 ? _a : undefined,\n                    state: (_b = options.state) !== null && _b !== void 0 ? _b : undefined,\n                    nonce: (_c = options.nonce) !== null && _c !== void 0 ? _c : undefined,\n                    usePopup: true,\n                });\n                AppleID.auth\n                    .signIn()\n                    .then((res) => {\n                    var _a, _b;\n                    const response = {\n                        response: {\n                            user: res.user,\n                            email: (_a = res.user) === null || _a === void 0 ? void 0 : _a.email,\n                            state: (_b = res.user) === null || _b === void 0 ? void 0 : _b.state,\n                            id_token: res.authorization.id_token,\n                            code: res.authorization.code,\n                        },\n                    };\n                    resolve(response);\n                })\n                    .catch((err) => {\n                    reject(err);\n                });\n            }\n            else {\n                reject('Unable to load Sign in with Apple JS framework.');\n            }\n        }\n        else {\n            reject('No options were provided.');\n        }\n    });\n}\nfunction loadAppleSignJS() {\n    return new Promise(resolve => {\n        if (!isAppleScriptLoaded) {\n            if (typeof window !== undefined) {\n                // const script = scriptjs;\n                loadScriptsInOrder([appleScriptUrl]);\n            }\n            else {\n                resolve(false);\n            }\n        }\n        else {\n            resolve(true);\n        }\n    });\n}\nexport class SigninWithAppleWeb extends WebPlugin {\n    async authorize(options) {\n        return authorize(options);\n    }\n}\nexport { authorize };\n//# sourceMappingURL=web.js.map","import { registerPlugin } from '@capacitor/core';\nimport { authorize } from './web';\nconst SigninWithApple = registerPlugin('SigninWithApple', {\n    web: () => import('./web').then(m => new m.SigninWithAppleWeb()),\n});\nexport * from './definitions';\nexport { SigninWithApple, authorize };\n//# sourceMappingURL=index.js.map"],"names":["WebPlugin","registerPlugin"],"mappings":"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"}